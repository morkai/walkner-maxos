// Part of <https://miracle.systems/p/walkner-maxos> licensed under <CC BY-NC-SA 4.0>

define(["app/core/util/fixTimeRange","app/core/util/idAndLabel","app/core/views/FilterView","app/data/controller","app/analytics/templates/chartsFilter"],function(t,e,a,r,i){"use strict";return a.extend({template:i,defaultFormData:function(){return{from:"",to:"",tag:""}},termToForm:{time:function(e,a,r){t.toFormData(r,a,"date+time")},tag:function(t,e,a){a[t]=e.args[1]}},serializeFormToQuery:function(e){var a=t.fromView(this),r=this.$id("tag").val();e.push({name:"eq",args:["tag",r]}),a.from&&e.push({name:"ge",args:["time",a.from]}),a.to&&e.push({name:"lt",args:["time",a.to]})},afterRender:function(){a.prototype.afterRender.call(this),this.$id("tag").select2({width:"300px",data:this.serializeSelect2Tags()})},serializeSelect2Tags:function(){return r.filter(function(t){return"avg"===t.get("archive")}).map(e)}})});