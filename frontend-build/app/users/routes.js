// Part of <https://miracle.systems/p/walkner-maxos> licensed under <CC BY-NC-SA 4.0>

define(["../i18n","../router","../viewport","../user","../core/View","../core/util/showDeleteFormPage","./User","./UserCollection","./pages/LogInFormPage","i18n!app/nls/users"],function(e,a,n,r,s,i,o,u,t){"use strict";var d=r.auth("USERS:VIEW"),p=r.auth("USERS:MANAGE");a.map("/login",function(){n.showPage(new t)}),a.map("/users",d,function(e){n.loadPage(["app/users/pages/UserListPage"],function(a){return new a({collection:new u(null,{rqlQuery:e.rql})})})}),a.map("/users/:id",function(e,a,n){e.params.id===r.data._id?n():d(e,a,n)},function(e){n.loadPage(["app/users/pages/UserDetailsPage"],function(a){return new a({model:new o({_id:e.params.id})})})}),a.map("/users;add",p,function(){n.loadPage(["app/core/pages/AddFormPage","app/users/views/UserFormView"],function(e,a){return new e({FormView:a,model:new o})})}),a.map("/users/:id;edit",function(e,a,n){e.params.id===r.data._id?n():p(e,a,n)},function(e){n.loadPage(["app/users/pages/UserEditFormPage"],function(a){return new a({model:new o({_id:e.params.id})})})}),a.map("/users/:id;delete",p,i.bind(null,o))});